(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(){const e=document.querySelector(".text-area"),t=e.selectionStart,n=e.selectionEnd;return console.log(t,n),{start:t,end:n}}function n(e){const t=document.querySelector(".text-area");t.selectionStart=e.start,t.selectionEnd=e.start}e.d({},{T:()=>s});const r=["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","Caps Lock","a","s","d","f","g","h","j","k","l",";","'","Enter","Shift","z","x","c","v","b","n","m",",",".","/","ArrowUp","Shift","Ctrl","Win","Alt","Space","Alt","Ctrl","ArrowLeft","ArrowLeftDown","ArrowRight","Del"];class o{constructor(e,t,n){this.keycode=e,this.keyLetter=t,this.number=n,this.button=document.createElement("button"),this.button.classList.add("key"),"ControlLeft"===e||"ControlRight"===e||"AltLeft"===e||"AltRight"===e||"MetaLeft"===e?this.button.classList.add("key-size-2"):"Tab"===e||"Backslash"===e?this.button.classList.add("key-size-3"):"Backspace"===e||"CapsLock"===e||"Enter"===e?this.button.classList.add("key-size-4"):"ShiftLeft"===e||"ShiftRight"===e?this.button.classList.add("key-size-5"):"Space"===e?this.button.classList.add("key-size-6"):this.button.classList.add("key-size-1"),this.button.innerHTML="ArrowUp"===e?"&#129045;":"ArrowLeft"===e?"&#129044;":"ArrowDown"===e?"&#129047;":"ArrowRight"===e?"&#129046;":"ShiftLeft"===e||"ShiftRight"===e?t+" &#8682;":"Enter"===e?e+" &#8626;":"Backspace"===e?e+" &#129044;":t,this.button.addEventListener("click",(()=>{this.pressKey()})),document.querySelector(".keyboard-div").append(this.button)}addKeyboardActive(){this.button.addEventListener("keydown",(()=>{this.button.classList.add("key_active")}))}removeKeyboardActive(){this.button.addEventListener("keyup",(()=>{this.button.classList.remove("key_active")}))}pressKey(){"MetaLeft"!==this.keycode&&("Backspace"===this.keycode?function(){const e=document.querySelector(".text-area"),r=t();r.start===r.end?(e.value=e.value.substring(0,r.start-1)+e.value.substring(r.end),0!==r.start&&r.start--):e.value=e.value.substring(0,r.start)+e.value.substring(r.end),e.focus(),n(r)}():"Enter"===this.keycode?function(){const e=document.querySelector(".text-area"),r=t();e.value=e.value.substring(0,r.start)+"\n"+e.value.substring(r.end),r.start++,e.focus(),n(r)}():"ArrowUp"===this.keycode||"ArrowDown"===this.keycode||"ArrowLeft"===this.keycode||"ArrowRight"===this.keycode?function(e){const r=document.querySelector(".text-area"),o=t();if("ArrowLeft"===e)0!==o.end&&o.end--,o.start=o.end;else if("ArrowRight"===e)o.end++,o.start=o.end;else if("ArrowUp"===e){const e=r.value;let t,n=0,s=0;for(let t=o.end-1;t>=0;t--)if("\n"===e[t]){n=t+1;break}t=o.end-n;for(let t=n-2;t>=0;t--)if("\n"===e[t]){s=t+1;break}o.end=s+t>=n?0===s&&0===n?0:n-1:s+t,o.start=o.end,console.log("text = ",e,"text.length = ",e.length,"currentStringPosition = ",t,"currentStringStartPosition = ",n,"previousStringStartPosition = ",s)}else if("ArrowDown"===e){const e=r.value;let t,n=0,s=e.length,i=e.length;for(let t=o.end-1;t>=0;t--)if("\n"===e[t]){n=t+1;break}t=o.end-n;for(let t=o.end;t<e.length;t++)if("\n"===e[t]){s=t;break}for(let t=s+2;t<e.length;t++)if("\n"===e[t]){i=t;break}console.log("text = ",e,"text.length = ",e.length,"cursorPositions.end = ",o.end,"currentStringPosition = ",t,"currentStringStartPosition = ",n,"currentStringEndPosition = ",s,"nextStringEndPosition = ",i),o.end=s+1+t>i?i:s+1+t,o.start=o.end}r.focus(),n(o)}(this.keycode):function(e){const r=document.querySelector(".text-area"),o=t();r.value=r.value.substring(0,o.start)+e.keyLetter+r.value.substring(o.end),o.start++,r.focus(),n(o)}(this))}}(new class{constructor(){}create(){const e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("textarea"),r=document.createElement("div"),o=document.createElement("div");e.classList.add("header-div"),t.classList.add("text-area-div"),n.classList.add("text-area"),r.classList.add("keyboard-div"),o.classList.add("footer-div"),document.body.append(e),document.body.append(t),t.append(n),document.body.append(r),document.body.append(o)}}).create();const s=[];["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","MetaLeft","AltLeft","Space","AltRight","ControlRight","ArrowLeft","ArrowDown","ArrowRight","Delete"].forEach(((e,t)=>{s[t]=new o(e,r[t],t),s[t].addKeyboardActive(),s[t].removeKeyboardActive()})),document.querySelector(".text-area").focus(),document.addEventListener("keydown",(()=>{if(event.isTrusted){let e="";s.forEach((t=>{event.preventDefault(),t.keycode===event.code&&(e=t)})),e&&(e.button.classList.add("key_active"),e.pressKey())}})),document.addEventListener("keyup",(()=>{if(event.isTrusted){let e="";s.forEach((t=>{t.keycode===event.code&&(e=t)})),e&&e.button.classList.remove("key_active")}})),document.addEventListener("click",(()=>{document.querySelector(".text-area").focus()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cGFjazovL3dlYnB1Y2stZGVtby93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJwdWNrLWRlbW8vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3dlYnB1Y2stZGVtby93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3dlYnB1Y2stZGVtby8uL3NyYy9mdW5jdGlvbnMvdGV4dEFyZWEuanMiLCJ3ZWJwYWNrOi8vd2VicHVjay1kZW1vLy4vc3JjL2NsYXNzZXMva2V5LmpzIiwid2VicGFjazovL3dlYnB1Y2stZGVtby8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJwdWNrLWRlbW8vLi9zcmMvY2xhc3Nlcy9maWVsZC5qcyIsIndlYnBhY2s6Ly93ZWJwdWNrLWRlbW8vLi9zcmMvZnVuY3Rpb25zL2dsb2JhbEV2ZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImV4cG9ydCB7IGVudGVyTGV0dGVyLCBkZWxldGVQcmV2b3VzTGV0dGVyLCBuZXh0U3RyaW5nLCBtb3ZlQ3Vyc29yIH07XHJcblxyXG5mdW5jdGlvbiBnZXRDdXJzb3JQb3NpdGlvbnMoKSB7XHJcbiAgY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGV4dC1hcmVhJyk7XHJcbiAgY29uc3Qgc3RhcnQgPSB0ZXh0QXJlYS5zZWxlY3Rpb25TdGFydDtcclxuICBjb25zdCBlbmQgPSB0ZXh0QXJlYS5zZWxlY3Rpb25FbmQ7XHJcbiAgY29uc29sZS5sb2coc3RhcnQsIGVuZCk7XHJcbiAgcmV0dXJuIHtcclxuICAgIHN0YXJ0OiBzdGFydCxcclxuICAgIGVuZDogZW5kXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBwbGFjZUN1cnNvcihjdXJzb3JQb3NpdGlvbnMpIHtcclxuICBjb25zdCB0ZXh0QXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXh0LWFyZWEnKTtcclxuICB0ZXh0QXJlYS5zZWxlY3Rpb25TdGFydCA9IGN1cnNvclBvc2l0aW9ucy5zdGFydDtcclxuICB0ZXh0QXJlYS5zZWxlY3Rpb25FbmQgPSBjdXJzb3JQb3NpdGlvbnMuc3RhcnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVudGVyTGV0dGVyKGJ1dHRvbk9iaikge1xyXG4gIGNvbnN0IHRleHRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRleHQtYXJlYScpO1xyXG4gIGNvbnN0IGN1cnNvclBvc2l0aW9ucyA9IGdldEN1cnNvclBvc2l0aW9ucygpO1xyXG4gIHRleHRBcmVhLnZhbHVlID0gdGV4dEFyZWEudmFsdWUuc3Vic3RyaW5nKDAsIGN1cnNvclBvc2l0aW9ucy5zdGFydCkgKyBidXR0b25PYmoua2V5TGV0dGVyICsgdGV4dEFyZWEudmFsdWUuc3Vic3RyaW5nKGN1cnNvclBvc2l0aW9ucy5lbmQpO1xyXG4gIGN1cnNvclBvc2l0aW9ucy5zdGFydCsrO1xyXG4gIHRleHRBcmVhLmZvY3VzKCk7XHJcbiAgcGxhY2VDdXJzb3IoY3Vyc29yUG9zaXRpb25zKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVsZXRlUHJldm91c0xldHRlcigpIHtcclxuICBjb25zdCB0ZXh0QXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXh0LWFyZWEnKTtcclxuICBjb25zdCBjdXJzb3JQb3NpdGlvbnMgPSBnZXRDdXJzb3JQb3NpdGlvbnMoKTtcclxuICBpZiAoY3Vyc29yUG9zaXRpb25zLnN0YXJ0ID09PSBjdXJzb3JQb3NpdGlvbnMuZW5kKSB7XHJcbiAgICB0ZXh0QXJlYS52YWx1ZSA9IHRleHRBcmVhLnZhbHVlLnN1YnN0cmluZygwLCBjdXJzb3JQb3NpdGlvbnMuc3RhcnQgLSAxKSArIHRleHRBcmVhLnZhbHVlLnN1YnN0cmluZyhjdXJzb3JQb3NpdGlvbnMuZW5kKTtcclxuICAgIGlmIChjdXJzb3JQb3NpdGlvbnMuc3RhcnQgIT09IDApIHtcclxuICAgICAgY3Vyc29yUG9zaXRpb25zLnN0YXJ0LS07XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIHRleHRBcmVhLnZhbHVlID0gdGV4dEFyZWEudmFsdWUuc3Vic3RyaW5nKDAsIGN1cnNvclBvc2l0aW9ucy5zdGFydCkgKyB0ZXh0QXJlYS52YWx1ZS5zdWJzdHJpbmcoY3Vyc29yUG9zaXRpb25zLmVuZCk7XHJcbiAgfVxyXG4gIHRleHRBcmVhLmZvY3VzKCk7XHJcbiAgcGxhY2VDdXJzb3IoY3Vyc29yUG9zaXRpb25zKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbmV4dFN0cmluZygpIHtcclxuICBjb25zdCB0ZXh0QXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXh0LWFyZWEnKTtcclxuICBjb25zdCBjdXJzb3JQb3NpdGlvbnMgPSBnZXRDdXJzb3JQb3NpdGlvbnMoKTtcclxuICB0ZXh0QXJlYS52YWx1ZSA9IHRleHRBcmVhLnZhbHVlLnN1YnN0cmluZygwLCBjdXJzb3JQb3NpdGlvbnMuc3RhcnQpICsgJ1xcbicgKyB0ZXh0QXJlYS52YWx1ZS5zdWJzdHJpbmcoY3Vyc29yUG9zaXRpb25zLmVuZCk7XHJcbiAgY3Vyc29yUG9zaXRpb25zLnN0YXJ0Kys7XHJcbiAgdGV4dEFyZWEuZm9jdXMoKTtcclxuICBwbGFjZUN1cnNvcihjdXJzb3JQb3NpdGlvbnMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtb3ZlQ3Vyc29yKGFycm93KSB7XHJcbiAgY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGV4dC1hcmVhJyk7XHJcbiAgY29uc3QgY3Vyc29yUG9zaXRpb25zID0gZ2V0Q3Vyc29yUG9zaXRpb25zKCk7XHJcbiAgaWYgKGFycm93ID09PSAnQXJyb3dMZWZ0Jykge1xyXG4gICAgaWYgKGN1cnNvclBvc2l0aW9ucy5lbmQgIT09IDApIHtcclxuICAgICAgY3Vyc29yUG9zaXRpb25zLmVuZC0tO1xyXG4gICAgfVxyXG4gICAgY3Vyc29yUG9zaXRpb25zLnN0YXJ0ID0gY3Vyc29yUG9zaXRpb25zLmVuZDtcclxuICB9IGVsc2UgaWYgKGFycm93ID09PSAnQXJyb3dSaWdodCcpIHtcclxuICAgIGN1cnNvclBvc2l0aW9ucy5lbmQrKztcclxuICAgIGN1cnNvclBvc2l0aW9ucy5zdGFydCA9IGN1cnNvclBvc2l0aW9ucy5lbmQ7XHJcbiAgfSBlbHNlIGlmIChhcnJvdyA9PT0gJ0Fycm93VXAnKSB7XHJcbiAgICBjb25zdCB0ZXh0ID0gdGV4dEFyZWEudmFsdWU7XHJcbiAgICBsZXQgY3VycmVudFN0cmluZ1Bvc2l0aW9uO1xyXG4gICAgbGV0IGN1cnJlbnRTdHJpbmdTdGFydFBvc2l0aW9uID0gMDtcclxuICAgIGxldCBwcmV2aW91c1N0cmluZ1N0YXJ0UG9zaXRpb24gPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IGN1cnNvclBvc2l0aW9ucy5lbmQgLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICBpZiAodGV4dFtpXSA9PT0gJ1xcbicpIHtcclxuICAgICAgICBjdXJyZW50U3RyaW5nU3RhcnRQb3NpdGlvbiA9IGkgKyAxO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjdXJyZW50U3RyaW5nUG9zaXRpb24gPSBjdXJzb3JQb3NpdGlvbnMuZW5kIC0gY3VycmVudFN0cmluZ1N0YXJ0UG9zaXRpb247XHJcbiAgICBmb3IgKGxldCBpID0gY3VycmVudFN0cmluZ1N0YXJ0UG9zaXRpb24gLSAyOyBpID49IDA7IGktLSkge1xyXG4gICAgICBpZiAodGV4dFtpXSA9PT0gJ1xcbicpIHtcclxuICAgICAgICBwcmV2aW91c1N0cmluZ1N0YXJ0UG9zaXRpb24gPSBpICsgMTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHByZXZpb3VzU3RyaW5nU3RhcnRQb3NpdGlvbiArIGN1cnJlbnRTdHJpbmdQb3NpdGlvbiA+PSBjdXJyZW50U3RyaW5nU3RhcnRQb3NpdGlvbikge1xyXG4gICAgICBpZiAocHJldmlvdXNTdHJpbmdTdGFydFBvc2l0aW9uID09PSAwICYmIGN1cnJlbnRTdHJpbmdTdGFydFBvc2l0aW9uID09PSAwKSB7XHJcbiAgICAgICAgY3Vyc29yUG9zaXRpb25zLmVuZCA9IDA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY3Vyc29yUG9zaXRpb25zLmVuZCA9IGN1cnJlbnRTdHJpbmdTdGFydFBvc2l0aW9uIC0gMTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY3Vyc29yUG9zaXRpb25zLmVuZCA9IHByZXZpb3VzU3RyaW5nU3RhcnRQb3NpdGlvbiArIGN1cnJlbnRTdHJpbmdQb3NpdGlvbjtcclxuICAgIH1cclxuICAgIGN1cnNvclBvc2l0aW9ucy5zdGFydCA9IGN1cnNvclBvc2l0aW9ucy5lbmQ7XHJcbiAgICBjb25zb2xlLmxvZygndGV4dCA9ICcsIHRleHQsICd0ZXh0Lmxlbmd0aCA9ICcsIHRleHQubGVuZ3RoLCAnY3VycmVudFN0cmluZ1Bvc2l0aW9uID0gJywgY3VycmVudFN0cmluZ1Bvc2l0aW9uLCAnY3VycmVudFN0cmluZ1N0YXJ0UG9zaXRpb24gPSAnLFxyXG4gICAgY3VycmVudFN0cmluZ1N0YXJ0UG9zaXRpb24sICdwcmV2aW91c1N0cmluZ1N0YXJ0UG9zaXRpb24gPSAnLCBwcmV2aW91c1N0cmluZ1N0YXJ0UG9zaXRpb24pO1xyXG4gIH0gZWxzZSBpZiAoYXJyb3cgPT09ICdBcnJvd0Rvd24nKSB7XHJcbiAgICBjb25zdCB0ZXh0ID0gdGV4dEFyZWEudmFsdWU7XHJcbiAgICBsZXQgY3VycmVudFN0cmluZ1Bvc2l0aW9uO1xyXG4gICAgbGV0IGN1cnJlbnRTdHJpbmdTdGFydFBvc2l0aW9uID0gMDtcclxuICAgIGxldCBjdXJyZW50U3RyaW5nRW5kUG9zaXRpb24gPSB0ZXh0Lmxlbmd0aDtcclxuICAgIGxldCBuZXh0U3RyaW5nRW5kUG9zaXRpb24gPSB0ZXh0Lmxlbmd0aDtcclxuICAgIGZvciAobGV0IGkgPSBjdXJzb3JQb3NpdGlvbnMuZW5kIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgaWYgKHRleHRbaV0gPT09ICdcXG4nKSB7XHJcbiAgICAgICAgY3VycmVudFN0cmluZ1N0YXJ0UG9zaXRpb24gPSBpICsgMTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY3VycmVudFN0cmluZ1Bvc2l0aW9uID0gY3Vyc29yUG9zaXRpb25zLmVuZCAtIGN1cnJlbnRTdHJpbmdTdGFydFBvc2l0aW9uO1xyXG4gICAgZm9yIChsZXQgaSA9IGN1cnNvclBvc2l0aW9ucy5lbmQ7IGkgPCB0ZXh0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmICh0ZXh0W2ldID09PSAnXFxuJykge1xyXG4gICAgICAgIGN1cnJlbnRTdHJpbmdFbmRQb3NpdGlvbiA9IGk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSBjdXJyZW50U3RyaW5nRW5kUG9zaXRpb24gKyAyOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAodGV4dFtpXSA9PT0gJ1xcbicpIHtcclxuICAgICAgICBuZXh0U3RyaW5nRW5kUG9zaXRpb24gPSBpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZygndGV4dCA9ICcsIHRleHQsICd0ZXh0Lmxlbmd0aCA9ICcsIHRleHQubGVuZ3RoLCAnY3Vyc29yUG9zaXRpb25zLmVuZCA9ICcsIGN1cnNvclBvc2l0aW9ucy5lbmQsICdjdXJyZW50U3RyaW5nUG9zaXRpb24gPSAnLFxyXG4gICAgY3VycmVudFN0cmluZ1Bvc2l0aW9uLCAnY3VycmVudFN0cmluZ1N0YXJ0UG9zaXRpb24gPSAnLFxyXG4gICAgY3VycmVudFN0cmluZ1N0YXJ0UG9zaXRpb24sICdjdXJyZW50U3RyaW5nRW5kUG9zaXRpb24gPSAnLCBjdXJyZW50U3RyaW5nRW5kUG9zaXRpb24sICduZXh0U3RyaW5nRW5kUG9zaXRpb24gPSAnLCBuZXh0U3RyaW5nRW5kUG9zaXRpb24pO1xyXG4gICAgaWYgKGN1cnJlbnRTdHJpbmdFbmRQb3NpdGlvbiArIDEgKyBjdXJyZW50U3RyaW5nUG9zaXRpb24gPiBuZXh0U3RyaW5nRW5kUG9zaXRpb24pIHtcclxuICAgICAgY3Vyc29yUG9zaXRpb25zLmVuZCA9IG5leHRTdHJpbmdFbmRQb3NpdGlvbjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGN1cnNvclBvc2l0aW9ucy5lbmQgPSBjdXJyZW50U3RyaW5nRW5kUG9zaXRpb24gKyAxICsgY3VycmVudFN0cmluZ1Bvc2l0aW9uO1xyXG4gICAgfVxyXG4gICAgY3Vyc29yUG9zaXRpb25zLnN0YXJ0ID0gY3Vyc29yUG9zaXRpb25zLmVuZDtcclxuICB9XHJcbiAgdGV4dEFyZWEuZm9jdXMoKTtcclxuICBwbGFjZUN1cnNvcihjdXJzb3JQb3NpdGlvbnMpO1xyXG59IiwiaW1wb3J0IHsgZW50ZXJMZXR0ZXIsIGRlbGV0ZVByZXZvdXNMZXR0ZXIsIG5leHRTdHJpbmcsIG1vdmVDdXJzb3IgfSBmcm9tIFwiLi4vZnVuY3Rpb25zL3RleHRBcmVhXCI7XHJcblxyXG5leHBvcnQge1xyXG4gIGtleWNvZGVzLFxyXG4gIGtleUxldHRlcnNFbixcclxuICBLZXlcclxufTtcclxuXHJcbmNvbnN0IGtleWNvZGVzID0gWydCYWNrcXVvdGUnLCAnRGlnaXQxJywgJ0RpZ2l0MicsICdEaWdpdDMnLCAnRGlnaXQ0JywgJ0RpZ2l0NScsICdEaWdpdDYnLCAnRGlnaXQ3JywgJ0RpZ2l0OCcsICdEaWdpdDknLCAnRGlnaXQwJyxcclxuICAnTWludXMnLCAnRXF1YWwnLCAnQmFja3NwYWNlJywgJ1RhYicsICdLZXlRJywgJ0tleVcnLCAnS2V5RScsICdLZXlSJywgJ0tleVQnLCAnS2V5WScsICdLZXlVJywgJ0tleUknLCAnS2V5TycsICdLZXlQJyxcclxuICAnQnJhY2tldExlZnQnLCAnQnJhY2tldFJpZ2h0JywgJ0JhY2tzbGFzaCcsICdDYXBzTG9jaycsICdLZXlBJywgJ0tleVMnLCAnS2V5RCcsICdLZXlGJywgJ0tleUcnLCAnS2V5SCcsICdLZXlKJywgJ0tleUsnLFxyXG4gICdLZXlMJywgJ1NlbWljb2xvbicsICdRdW90ZScsICdFbnRlcicsICdTaGlmdExlZnQnLCAnS2V5WicsICdLZXlYJywgJ0tleUMnLCAnS2V5VicsICdLZXlCJywgJ0tleU4nLCAnS2V5TScsICdDb21tYScsICdQZXJpb2QnLFxyXG4gICdTbGFzaCcsICdBcnJvd1VwJywgJ1NoaWZ0UmlnaHQnLCAnQ29udHJvbExlZnQnLCAnTWV0YUxlZnQnLCAnQWx0TGVmdCcsICdTcGFjZScsICdBbHRSaWdodCcsICdDb250cm9sUmlnaHQnLCAnQXJyb3dMZWZ0JyxcclxuICAnQXJyb3dEb3duJywgJ0Fycm93UmlnaHQnLCAnRGVsZXRlJ107XHJcbmNvbnN0IGtleUxldHRlcnNFbiA9IFsnYCcsICcxJywgJzInLCAnMycsICc0JywgJzUnLCAnNicsICc3JywgJzgnLCAnOScsICcwJywgJy0nLCAnPScsICdCYWNrc3BhY2UnLCAnVGFiJywgJ3EnLCAndycsICdlJywgJ3InLCAndCcsICd5JyxcclxuICAndScsICdpJywgJ28nLCAncCcsICdbJywgJ10nLCAnXFxcXCcsICdDYXBzIExvY2snLCAnYScsICdzJywgJ2QnLCAnZicsICdnJywgJ2gnLCAnaicsICdrJywgJ2wnLCAnOycsICdcXCcnLCAnRW50ZXInLCAnU2hpZnQnLFxyXG4gICd6JywgJ3gnLCAnYycsICd2JywgJ2InLCAnbicsICdtJywgJywnLCAnLicsICcvJywgJ0Fycm93VXAnLCAnU2hpZnQnLCAnQ3RybCcsICdXaW4nLCAnQWx0JywgJ1NwYWNlJywgJ0FsdCcsICdDdHJsJywgJ0Fycm93TGVmdCcsXHJcbiAgJ0Fycm93TGVmdERvd24nLCAnQXJyb3dSaWdodCcsICdEZWwnXTtcclxuXHJcbmNsYXNzIEtleSB7XHJcbiAgY29uc3RydWN0b3Ioa2V5Y29kZSwga2V5TGV0dGVyLCBudW1iZXIpIHtcclxuICAgIHRoaXMua2V5Y29kZSA9IGtleWNvZGU7XHJcbiAgICB0aGlzLmtleUxldHRlciA9IGtleUxldHRlcjtcclxuICAgIHRoaXMubnVtYmVyID0gbnVtYmVyO1xyXG4gICAgdGhpcy5idXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2tleScpO1xyXG4gICAgaWYgKGtleWNvZGUgPT09ICdDb250cm9sTGVmdCcgfHwga2V5Y29kZSA9PT0gJ0NvbnRyb2xSaWdodCcgfHwga2V5Y29kZSA9PT0gJ0FsdExlZnQnIHx8IGtleWNvZGUgPT09ICdBbHRSaWdodCcgfHwga2V5Y29kZSA9PT0gJ01ldGFMZWZ0Jykge1xyXG4gICAgICB0aGlzLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdrZXktc2l6ZS0yJyk7XHJcbiAgICB9IGVsc2UgaWYgKGtleWNvZGUgPT09ICdUYWInIHx8IGtleWNvZGUgPT09ICdCYWNrc2xhc2gnKSB7XHJcbiAgICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2tleS1zaXplLTMnKTtcclxuICAgIH0gZWxzZSBpZiAoa2V5Y29kZSA9PT0gJ0JhY2tzcGFjZScgfHwga2V5Y29kZSA9PT0gJ0NhcHNMb2NrJyB8fCBrZXljb2RlID09PSAnRW50ZXInKSB7XHJcbiAgICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2tleS1zaXplLTQnKTtcclxuICAgIH0gZWxzZSBpZiAoa2V5Y29kZSA9PT0gJ1NoaWZ0TGVmdCcgfHwga2V5Y29kZSA9PT0gJ1NoaWZ0UmlnaHQnKSB7XHJcbiAgICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2tleS1zaXplLTUnKTtcclxuICAgIH0gZWxzZSBpZiAoa2V5Y29kZSA9PT0gJ1NwYWNlJykge1xyXG4gICAgICB0aGlzLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdrZXktc2l6ZS02Jyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdrZXktc2l6ZS0xJyk7XHJcbiAgICB9XHJcbiAgICBpZiAoa2V5Y29kZSA9PT0gJ0Fycm93VXAnKSB7XHJcbiAgICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9ICcmIzEyOTA0NTsnO1xyXG4gICAgfSBlbHNlIGlmIChrZXljb2RlID09PSAnQXJyb3dMZWZ0Jykge1xyXG4gICAgICB0aGlzLmJ1dHRvbi5pbm5lckhUTUwgPSAnJiMxMjkwNDQ7JztcclxuICAgIH0gZWxzZSBpZiAoa2V5Y29kZSA9PT0gJ0Fycm93RG93bicpIHtcclxuICAgICAgdGhpcy5idXR0b24uaW5uZXJIVE1MID0gJyYjMTI5MDQ3Oyc7XHJcbiAgICB9IGVsc2UgaWYgKGtleWNvZGUgPT09ICdBcnJvd1JpZ2h0Jykge1xyXG4gICAgICB0aGlzLmJ1dHRvbi5pbm5lckhUTUwgPSAnJiMxMjkwNDY7JztcclxuICAgIH0gZWxzZSBpZiAoa2V5Y29kZSA9PT0gJ1NoaWZ0TGVmdCcgfHwga2V5Y29kZSA9PT0gJ1NoaWZ0UmlnaHQnKSB7XHJcbiAgICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9IGtleUxldHRlciArICcgJiM4NjgyOyc7XHJcbiAgICB9IGVsc2UgaWYgKGtleWNvZGUgPT09ICdFbnRlcicpIHtcclxuICAgICAgdGhpcy5idXR0b24uaW5uZXJIVE1MID0ga2V5Y29kZSArICcgJiM4NjI2Oyc7XHJcbiAgICB9IGVsc2UgaWYgKGtleWNvZGUgPT09ICdCYWNrc3BhY2UnKSB7XHJcbiAgICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9IGtleWNvZGUgKyAnICYjMTI5MDQ0Oyc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmJ1dHRvbi5pbm5lckhUTUwgPSBrZXlMZXR0ZXI7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMucHJlc3NLZXkoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGtleWJvYXJkRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmtleWJvYXJkLWRpdicpO1xyXG4gICAga2V5Ym9hcmREaXYuYXBwZW5kKHRoaXMuYnV0dG9uKTtcclxuICB9XHJcbiAgYWRkS2V5Ym9hcmRBY3RpdmUoKSB7XHJcbiAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKCkgPT4ge1xyXG4gICAgICB0aGlzLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdrZXlfYWN0aXZlJyk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgcmVtb3ZlS2V5Ym9hcmRBY3RpdmUoKSB7XHJcbiAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsICgpID0+IHtcclxuICAgICAgdGhpcy5idXR0b24uY2xhc3NMaXN0LnJlbW92ZSgna2V5X2FjdGl2ZScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHByZXNzS2V5KCkge1xyXG4gICAgaWYgKHRoaXMua2V5Y29kZSAhPT0gJ01ldGFMZWZ0Jykge1xyXG4gICAgICBpZiAodGhpcy5rZXljb2RlID09PSAnQmFja3NwYWNlJykge1xyXG4gICAgICAgIGRlbGV0ZVByZXZvdXNMZXR0ZXIoKTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmtleWNvZGUgPT09ICdFbnRlcicpIHtcclxuICAgICAgICBuZXh0U3RyaW5nKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5rZXljb2RlID09PSAnQXJyb3dVcCcgfHwgdGhpcy5rZXljb2RlID09PSAnQXJyb3dEb3duJyB8fCB0aGlzLmtleWNvZGUgPT09ICdBcnJvd0xlZnQnIHx8IHRoaXMua2V5Y29kZSA9PT0gJ0Fycm93UmlnaHQnKSB7XHJcbiAgICAgICAgbW92ZUN1cnNvcih0aGlzLmtleWNvZGUpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGVudGVyTGV0dGVyKHRoaXMpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59OyIsImltcG9ydCB7IEZpZWxkIH0gZnJvbSBcIi4vY2xhc3Nlcy9maWVsZFwiO1xyXG5pbXBvcnQgeyBrZXljb2Rlcywga2V5TGV0dGVyc0VuLCBLZXkgfSBmcm9tIFwiLi9jbGFzc2VzL2tleVwiO1xyXG5pbXBvcnQgeyBhZGRLZXlib2FyZExpc3RlbmVyLCBmb2N1c1RleHRBcmVhIH0gZnJvbSBcIi4vZnVuY3Rpb25zL2dsb2JhbEV2ZW50c1wiO1xyXG5leHBvcnQgeyBidXR0b25zQXJyIH07XHJcblxyXG5jb25zdCBmaWVsZCA9IG5ldyBGaWVsZCgpO1xyXG5cclxuZmllbGQuY3JlYXRlKCk7XHJcblxyXG5jb25zdCBidXR0b25zQXJyID0gW107XHJcblxyXG5rZXljb2Rlcy5mb3JFYWNoKChrZXljb2RlLCBudW1iZXIpID0+IHtcclxuICBidXR0b25zQXJyW251bWJlcl0gPSBuZXcgS2V5KGtleWNvZGUsIGtleUxldHRlcnNFbltudW1iZXJdLCBudW1iZXIpO1xyXG4gIGJ1dHRvbnNBcnJbbnVtYmVyXS5hZGRLZXlib2FyZEFjdGl2ZSgpOyBcclxuICBidXR0b25zQXJyW251bWJlcl0ucmVtb3ZlS2V5Ym9hcmRBY3RpdmUoKTsgXHJcbn0pO1xyXG5cclxuICBjb25zdCB0ZXh0QXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXh0LWFyZWEnKTtcclxuICB0ZXh0QXJlYS5mb2N1cygpO1xyXG4gIGFkZEtleWJvYXJkTGlzdGVuZXIoKTtcclxuICBmb2N1c1RleHRBcmVhKCk7IiwiZXhwb3J0IHsgRmllbGQgfTtcclxuXHJcbmNsYXNzIEZpZWxkIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICB9XHJcbiAgY3JlYXRlKCkge1xyXG4gICAgY29uc3QgaGVhZGVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCB0ZXh0QXJlYURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xyXG4gICAgY29uc3Qga2V5Ym9hcmREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnN0IGZvb3RlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuICAgIGhlYWRlckRpdi5jbGFzc0xpc3QuYWRkKCdoZWFkZXItZGl2Jyk7XHJcbiAgICB0ZXh0QXJlYURpdi5jbGFzc0xpc3QuYWRkKCd0ZXh0LWFyZWEtZGl2Jyk7XHJcbiAgICB0ZXh0QXJlYS5jbGFzc0xpc3QuYWRkKCd0ZXh0LWFyZWEnKTtcclxuICAgIGtleWJvYXJkRGl2LmNsYXNzTGlzdC5hZGQoJ2tleWJvYXJkLWRpdicpO1xyXG4gICAgZm9vdGVyRGl2LmNsYXNzTGlzdC5hZGQoJ2Zvb3Rlci1kaXYnKTtcclxuXHJcbiAgICAvL3RleHRBcmVhLnNldEF0dHJpYnV0ZSgnbWF4bGVuZ3RoJywgJzEwJyk7XHJcbiAgICAvL3RleHRBcmVhLnNldEF0dHJpYnV0ZSgnYXV0b2ZvY3VzJywgJycpO1xyXG5cclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kKGhlYWRlckRpdik7XHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZCh0ZXh0QXJlYURpdik7XHJcbiAgICB0ZXh0QXJlYURpdi5hcHBlbmQodGV4dEFyZWEpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmQoa2V5Ym9hcmREaXYpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmQoZm9vdGVyRGl2KTtcclxuICB9O1xyXG59OyIsImV4cG9ydCB7IGFkZEtleWJvYXJkTGlzdGVuZXIsIGZvY3VzVGV4dEFyZWEgfTtcclxuaW1wb3J0IHsgYnV0dG9uc0FyciB9IGZyb20gJy4uL2luZGV4JztcclxuXHJcbmZ1bmN0aW9uIGFkZEtleWJvYXJkTGlzdGVuZXIoKSB7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsICgpID0+IHtcclxuICAgIGlmIChldmVudC5pc1RydXN0ZWQpIHtcclxuICAgICAgbGV0IHRoaXNCdXR0b24gPSAnJztcclxuICAgICAgYnV0dG9uc0Fyci5mb3JFYWNoKGJ1dHRvbk9iaiA9PiB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBpZiAoYnV0dG9uT2JqLmtleWNvZGUgPT09IGV2ZW50LmNvZGUpIHtcclxuICAgICAgICAgIHRoaXNCdXR0b24gPSBidXR0b25PYmo7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHRoaXNCdXR0b24pIHtcclxuICAgICAgICB0aGlzQnV0dG9uLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdrZXlfYWN0aXZlJyk7XHJcbiAgICAgICAgdGhpc0J1dHRvbi5wcmVzc0tleSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LmlzVHJ1c3RlZCkge1xyXG4gICAgICBsZXQgdGhpc0J1dHRvbiA9ICcnO1xyXG4gICAgICBidXR0b25zQXJyLmZvckVhY2goYnV0dG9uT2JqID0+IHtcclxuICAgICAgICBpZiAoYnV0dG9uT2JqLmtleWNvZGUgPT09IGV2ZW50LmNvZGUpIHtcclxuICAgICAgICAgIHRoaXNCdXR0b24gPSBidXR0b25PYmo7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHRoaXNCdXR0b24pIHtcclxuICAgICAgICB0aGlzQnV0dG9uLmJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdrZXlfYWN0aXZlJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZm9jdXNUZXh0QXJlYSgpIHtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGNvbnN0IHRleHRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRleHQtYXJlYScpO1xyXG4gICAgdGV4dEFyZWEuZm9jdXMoKTtcclxuICB9KTtcclxufSJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImdldEN1cnNvclBvc2l0aW9ucyIsInRleHRBcmVhIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3RhcnQiLCJzZWxlY3Rpb25TdGFydCIsImVuZCIsInNlbGVjdGlvbkVuZCIsImNvbnNvbGUiLCJsb2ciLCJwbGFjZUN1cnNvciIsImN1cnNvclBvc2l0aW9ucyIsImtleUxldHRlcnNFbiIsIktleSIsImNvbnN0cnVjdG9yIiwia2V5Y29kZSIsImtleUxldHRlciIsIm51bWJlciIsInRoaXMiLCJidXR0b24iLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJIVE1MIiwiYWRkRXZlbnRMaXN0ZW5lciIsInByZXNzS2V5IiwiYXBwZW5kIiwiYWRkS2V5Ym9hcmRBY3RpdmUiLCJyZW1vdmVLZXlib2FyZEFjdGl2ZSIsInJlbW92ZSIsInZhbHVlIiwic3Vic3RyaW5nIiwiZm9jdXMiLCJkZWxldGVQcmV2b3VzTGV0dGVyIiwibmV4dFN0cmluZyIsImFycm93IiwidGV4dCIsImN1cnJlbnRTdHJpbmdQb3NpdGlvbiIsImN1cnJlbnRTdHJpbmdTdGFydFBvc2l0aW9uIiwicHJldmlvdXNTdHJpbmdTdGFydFBvc2l0aW9uIiwiaSIsImxlbmd0aCIsImN1cnJlbnRTdHJpbmdFbmRQb3NpdGlvbiIsIm5leHRTdHJpbmdFbmRQb3NpdGlvbiIsIm1vdmVDdXJzb3IiLCJidXR0b25PYmoiLCJlbnRlckxldHRlciIsImNyZWF0ZSIsImhlYWRlckRpdiIsInRleHRBcmVhRGl2Iiwia2V5Ym9hcmREaXYiLCJmb290ZXJEaXYiLCJib2R5IiwiYnV0dG9uc0FyciIsImZvckVhY2giLCJldmVudCIsImlzVHJ1c3RlZCIsInRoaXNCdXR0b24iLCJwcmV2ZW50RGVmYXVsdCIsImNvZGUiXSwic291cmNlUm9vdCI6IiJ9